<div class="main">
    <div class="main-header">
        <img src="/assets/img/menu-network.png" class="main-icon" />
        <span class="main-title">Create Endpoint</span>
        <span class="main-close" v-on:click="close">×</span>
    </div>
    <div class="main-body max-520 form">
        <div class="hint">Server will create listener to listen this endpoint and accept client requests. An endpoint can have multiple destinations. You can either setup initiative destinations or let an agent connect to. The address can be IPv4 or IPv6, port should be 1-65535 and not conflict with existed ports.</div>

        <h5 class="section">Endpoint Basic</h5>
        <table class="table">
            <colgroup>
                <col style="width: 150px" />
                <col />
            </colgroup>
            <tr>
                <td>Name<span class="red">*</span></td>
                <td><input type="text" class="textbox" v-model="form.name" v-bind:class="{ 'invalid': validateFields && !/^.{1,32}$/.test(form.name) }" /></td>
            </tr>
            <tr>
                <td>Protocol<span class="red">*</span></td>
                <td>
                    <select class="textbox" v-model="form.protocol" v-bind:class="{ 'invalid': validateFields && !form.protocol }">
                        <option v-for="x in protocols">{{ x }}</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Endpoint Address<span class="red">*</span></td>
                <td><input type="text" class="textbox" v-model="form.address" v-bind:class="{ 'invalid': (validateFields && !/^((^\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\s*$)|(^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$))$/.test(form.address)) }" /></td>
            </tr>
            <tr>
                <td>Endpoint Port<span class="red">*</span></td>
                <td><input type="text" class="textbox" v-model="form.port" v-bind:class="{ 'invalid': validateFields && (!form.port || form.port < 0 || form.port > 65535) }" /></td>
            </tr>
        </table>

        <h5 class="section">Endpoint Handlers</h5>
        <table class="table">
            <colgroup>
                <col style="width: 150px" />
                <col />
            </colgroup>
            <tr>
                <td>Router<span class="red">*</span></td>
                <td>
                    <select class="textbox" v-model="form.routerId" v-bind:class="{ 'invalid': validateFields && !isRouterValid() }">
                        <option v-for="x in streamRouters" v-if="form.protocol == 'TCP'" v-bind:value="x.id">{{ x.name }} ({{ x.id }})</option>
                        <option v-for="x in packetRouters" v-if="form.protocol == 'UDP'" v-bind:value="x.id">{{ x.name }} ({{ x.id }})</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Tunnel Provider<span class="red">*</span></td>
                <td>
                    <select class="textbox" v-model="form.tunnelId" v-bind:class="{ 'invalid': validateFields && !isTunnelValid() }">
                        <option v-for="x in streamTunnels" v-if="form.protocol == 'TCP'" v-bind:value="x.id">{{ x.name }} ({{ x.id }})</option>
                        <option v-for="x in packetTunnels" v-if="form.protocol == 'UDP'" v-bind:value="x.id">{{ x.name }} ({{ x.id }})</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>
    <div class="footer">
        <div class="footer-inner">
            <a class="button" v-on:click="create">Create</a>
        </div>
    </div>
</div>